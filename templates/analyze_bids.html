<!DOCTYPE html>
<html lang="en">
<head>
    <title>Analyze Quotes</title>
</head>
<body>
    <h1>Quote Analysis</h1>
    <h2>Ranked Quotes</h2>
    <ul>
        {% for quote in analysis.ranked_quotes %}
        <li>
            Supplier: {{ quote.supplier_name }}<br>
            Price: ${{ quote.price }}<br>
            Delivery Time: {{ quote.delivery_time }} days
        </li>
        {% endfor %}
    </ul>
    <h2>AI Insights</h2>
    <ul>
        {% for insight in analysis.ai_insights %}
        <li>{{ insight }}</li>
        {% endfor %}
    </ul>
    <button type="button" onclick="finalizeTender()">Finalize Tender</button>
    <script>
        function finalizeTender() {
            const selectedSuppliers = [...document.querySelectorAll("input[type=checkbox]:checked")].map(cb => cb.value);
            fetch('/finalize_tender', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ selected_suppliers: selectedSuppliers })
            })
            .then(response => response.json())
            .then(data => alert(data.message))
            .catch(error => alert("Error finalizing tender: " + error));
        }
    </script>
</body>
</html>
