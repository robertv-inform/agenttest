<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Procurement Event</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <div class="max-w-4xl mx-auto py-10">
        <h1 class="text-2xl font-bold mb-4 text-center">Create Procurement Event</h1>
        <form id="eventForm" class="bg-white p-6 shadow-md rounded">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label for="base_language" class="block text-sm font-medium">Base Language</label>
                    <input type="text" id="base_language" class="w-full p-2 border border-gray-300 rounded" required>
                </div>
                <div>
                    <label for="regions" class="block text-sm font-medium">Regions</label>
                    <input type="text" id="regions" class="w-full p-2 border border-gray-300 rounded" required>
                </div>
                <div>
                    <label for="departments" class="block text-sm font-medium">Departments</label>
                    <input type="text" id="departments" class="w-full p-2 border border-gray-300 rounded" required>
                </div>
                <div>
                    <label for="currency" class="block text-sm font-medium">Currency</label>
                    <input type="text" id="currency" class="w-full p-2 border border-gray-300 rounded" required>
                </div>
                <div>
                    <label for="commodity" class="block text-sm font-medium">Commodity</label>
                    <input type="text" id="commodity" class="w-full p-2 border border-gray-300 rounded" required>
                </div>
                <div>
                    <label for="contract_months" class="block text-sm font-medium">Contract Months</label>
                    <input type="number" id="contract_months" class="w-full p-2 border border-gray-300 rounded" required>
                </div>
                <div>
                    <label for="contract_effective_date" class="block text-sm font-medium">Contract Effective Date</label>
                    <input type="date" id="contract_effective_date" class="w-full p-2 border border-gray-300 rounded" required>
                </div>
                <div>
                    <label for="quantity" class="block text-sm font-medium">Quantity</label>
                    <input type="number" id="quantity" class="w-full p-2 border border-gray-300 rounded" required>
                </div>
                <div>
                    <label for="budget" class="block text-sm font-medium">Budget</label>
                    <input type="number" id="budget" class="w-full p-2 border border-gray-300 rounded" required>
                </div>
            </div>
            <button type="button" onclick="submitEvent()" class="bg-blue-600 text-white px-4 py-2 rounded mt-6 w-full hover:bg-blue-700">
                Submit
            </button>
        </form>
        <div id="recommendations" class="mt-10"></div>
    </div>
    <script>
        function submitEvent() {
            const buyerInput = {
                base_language: document.getElementById("base_language").value,
                regions: document.getElementById("regions").value,
                departments: document.getElementById("departments").value,
                currency: document.getElementById("currency").value,
                commodity: document.getElementById("commodity").value,
                contract_months: document.getElementById("contract_months").value,
                contract_effective_date: document.getElementById("contract_effective_date").value,
                quantity: document.getElementById("quantity").value,
                budget: document.getElementById("budget").value
            };

            fetch('/get_suppliers', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(buyerInput)
            })
            .then(response => response.json())
            .then(data => displayRecommendations(data))
            .catch(error => alert("Error fetching suppliers: " + error));
        }

        function displayRecommendations(data) {
            const container = document.getElementById("recommendations");
            container.innerHTML = `
                <h2 class="text-xl font-bold">Supplier Recommendations</h2>
            `;
            const suppliers = data.ranked_suppliers;
            suppliers.forEach(supplier => {
                container.innerHTML += `
                    <div class="mt-4 p-4 bg-gray-50 border border-gray-200 rounded">
                        <strong>${supplier.supplier_name}</strong> (Score: ${supplier.score})<br>
                        Match Percentage: ${supplier.match_percentage}%<br>
                        Ranking Reason: ${supplier.ranking_reason}<br>
                        <strong>AI Insights:</strong> ${supplier.ai_insights.trends.join(", ")}
                    </div>
                `;
            });
        }
    </script>
</body>
</html>
